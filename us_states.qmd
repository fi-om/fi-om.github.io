---
title: "US States"
editor_options: 
  chunk_output_type: console
execute:
  echo: false
---

```{r, include = FALSE}
library(maps)
library(viridis)
library(tidyverse)
library(tidycensus)
```

```{r, include = FALSE}
HIC <- read_csv("Data/2023-HIC.csv")
us_states <- map_data("state")

HIC <- HIC |> 
  mutate(
    state = tolower(state.name[match(CocState, state.abb)])
  ) |> 
  group_by(state) |> 
  summarise(
    n_missions = n()
  )
```

```{r}
HIC |>
  right_join(us_states, by = c("state" = "region")) |> 
  ggplot(mapping = aes(x = long, y = lat,
                          group = group)) + 
  geom_polygon(aes(fill = n_missions), color = "black") + 
  coord_map() + 
  theme_void() +  
  scale_fill_gradient2(midpoint = mean(HIC$n_missions), breaks = c(4000, 3000, 2000, 1000, 566), labels = c(4000, 3000, 2000, 1000, "556 (National Average)")) +
  labs(
    title = "Housing Inventory Count by State compared to national average",
    fill = "Number of missions"
  )
```

From the plot, we can see that there is a significant difference in the number of shelters and housing for people experiencing homelessness between states. California seems to have eight times more homeless housing projects than the national average. Minnesota is one of the few Midwestern states who are above the national average. However, this map does not tell the whole story, as California has the highest homeless population in the country. However, this plot can give insight but must be viewed in a larger context. One must also take into account the homeless per capita numbers as well as population density. It would be interesting to calculate the Moran's I of the number of missions per homeless population.
